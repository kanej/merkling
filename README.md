# merkling

[![JavaScript Style Guide](https://img.shields.io/badge/code_style-standard-brightgreen.svg?style=flat-square)](https://standardjs.com)
[![semantic-release](https://img.shields.io/badge/%20%20%F0%9F%93%A6%F0%9F%9A%80-semantic--release-e10079.svg)](https://github.com/semantic-release/semantic-release)
[![standard-readme compliant](https://img.shields.io/badge/standard--readme-OK-green.svg?style=flat-square)](https://github.com/RichardLitt/standard-readme)

> A js library for persisting json objects to the IPFS merkle forest

The IPFS project exposes an underlying graph data structure where each link is a hash, this supports the peer to peer file sharing and goes under the Interplanetary Linked Data project (IPLD) project. Merkling is a small library for interacting with the IPLD graph.

## Table of Contents

-   [Install](#install)
-   [Usage](#usage)
-   [API](#api)
-   [Maintainers](#maintainers)
-   [Contribute](#contribute)
-   [License](#license)

## Install

```bash
npm install --save merkling
```

## Usage

Merkling requires pulling in ipfs.

```javascript
const Merkling = require('merkling').Merkling
const IPFS = require('ipfs')

const node = new IPFS()

node.on('ready', async () => {
    const client = new Merkling({ ipfs: node })
    const session = client.createSession()

    const feed = session.create({ title: 'On Poetry' })

    const feed = session.create({
      title: 'Poetry',
      author: 'P. Kavanagh',
      posts: null
    })

    const post1 = session.create({
      text: 'Beauty was that, Far vanished flame, Call it a star, wanting better name',
      next: null
    })

    const post2 = session.create({
      text: 'And gaze vaguely until, Nothing is left, Save a grey ghost-hill'
    })

    const post3 = session.create({
      text: 'Here wait I, On the world\'s rim, Stretching out hands, To Seraphim'
    })

    await session.save()

    const hash = Merkling.cid(feed).toBaseEncodedString()

    node.dag.get(`${hash}/head/next`, (err, saved) => {
      if (err) {
        throw err
      }

      console.log(saved.value)

      node.stop(() => {
        process.exit()
      })
    })
  })
})
```

## API

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

#### Table of Contents

-   [Merkling](#merkling)
    -   [create](#create)
    -   [save](#save)
    -   [get](#get)
    -   [load](#load)
    -   [resolve](#resolve)

### Merkling

Merkling entrypoint

**Parameters**

-   `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** setup options for this merkling instance

#### create

Create an IPLD node from a js object.
The IPLD node must be saved before it is persisted.

**Parameters**

-   `obj` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** a js object

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** an unsaved IPLD node

#### save

Persist a js object or IPLD node to the IPLD graph

**Parameters**

-   `obj` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** a js object or IPLD node

#### get

Given an IPLD id, retrieve the value from the IPLD graph
as a js object

**Parameters**

-   `cid` **([Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object) \| [String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String))** 

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** an IPLD node

#### load

Given an IPLD id, create an unloaded IPLD node, that can
be used in persisting

**Parameters**

-   `cid` **([Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object) \| [String](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String))** 

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** an unloaded IPLD node

#### resolve

Takes an unloaded IPLD node and loads in the
object for the node's hash from IPLD

**Parameters**

-   `obj` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** an unloaded IPLD node

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** a saved IPLD node

## Maintainers

[@kanej](https://github.com/kanej)

## Contribute

See [the contribute file](contribute.md)!

PRs accepted.

Small note: If editing the README, please conform to the [standard-readme](https://github.com/RichardLitt/standard-readme) specification.

## License

MIT Â© 2018 John Kane
